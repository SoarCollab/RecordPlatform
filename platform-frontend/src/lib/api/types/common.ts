// ===== Common Types =====

/**
 * 后端统一响应格式
 * @see ResultEnum.java
 */
export interface Result<T> {
  code: number;
  message: string;
  data: T;
}

/**
 * 分页响应格式
 * @see MyBatis Plus IPage
 */
export interface Page<T> {
  records: T[];
  total: number;
  size: number;
  current: number;
  pages: number;
}

/**
 * 分页请求参数
 * @note 参数名与后端 Controller 对齐: pageNum, pageSize
 */
export interface PageParams {
  pageNum?: number;
  pageSize?: number;
}

/**
 * 错误码枚举 (对应 ResultEnum.java)
 * 编码规范：
 * - 200: 成功
 * - 400-499: 客户端错误
 * - 500-599: 服务端错误
 * - 10000-19999: 参数校验错误
 * - 20000-29999: 用户/认证错误
 * - 30000-39999: 外部服务错误（区块链、存储）
 * - 40000-49999: 系统内部错误
 * - 50000-59999: 业务数据错误
 * - 60000-69999: 消息服务错误
 * - 70000-79999: 权限控制错误
 */
export const ResultCode = {
  // 通用状态码
  SUCCESS: 200,
  FAIL: 500,

  // 参数错误 10000-19999
  PARAM_ERROR: 10000,
  PARAM_IS_INVALID: 10001,
  PARAM_IS_BLANK: 10002,
  PARAM_TYPE_BIND_ERROR: 10003,
  PARAM_NOT_COMPLETE: 10004,
  JSON_PARSE_ERROR: 10005,

  // 用户错误 20000-29999
  USER_NOT_LOGGED_IN: 20001,
  USER_LOGIN_ERROR: 20002,
  USER_ACCOUNT_FORBIDDEN: 20003,
  USER_NOT_EXIST: 20004,
  USER_HAS_EXISTED: 20005,
  USER_ACCOUNT_LOCKED: 20006,

  // 外部服务错误 30000-39999
  CONTRACT_ERROR: 30001,
  INVALID_RETURN_VALUE: 30002,
  GET_USER_FILE_ERROR: 30003,
  DELETE_USER_FILE_ERROR: 30004,
  GET_USER_SHARE_FILE_ERROR: 30005,
  BLOCKCHAIN_ERROR: 30006,
  TRANSACTION_NOT_FOUND: 30007,
  TRANSACTION_RECEIPT_NOT_FOUND: 30008,
  FILE_SERVICE_ERROR: 30009,
  SERVICE_CIRCUIT_OPEN: 30010,
  SERVICE_TIMEOUT: 30011,

  // 系统错误 40000-49999
  FILE_MAX_SIZE_OVERFLOW: 40001,
  FILE_ACCEPT_NOT_SUPPORT: 40002,
  SYSTEM_BUSY: 40003,
  RATE_LIMIT_EXCEEDED: 40004,
  SERVICE_UNAVAILABLE: 40005,

  // 数据错误 50000-59999
  RESULT_DATA_NONE: 50001,
  DATA_IS_WRONG: 50002,
  DATA_ALREADY_EXISTED: 50003,
  AUTH_CODE_ERROR: 50004,
  FILE_UPLOAD_ERROR: 50005,
  FILE_DOWNLOAD_ERROR: 50006,
  FILE_DELETE_ERROR: 50007,
  FILE_NOT_EXIST: 50008,
  FILE_EMPTY: 50009,
  FILE_RECORD_ERROR: 50010,
  /** 分享已被取消 */
  SHARE_CANCELLED: 50011,
  /** 分享已过期 */
  SHARE_EXPIRED: 50012,

  // 消息服务错误 60000-69999
  MESSAGE_NOT_FOUND: 60001,
  CONVERSATION_NOT_FOUND: 60002,
  CANNOT_MESSAGE_SELF: 60003,
  ANNOUNCEMENT_NOT_FOUND: 60004,
  TICKET_NOT_FOUND: 60005,
  TICKET_ALREADY_CLOSED: 60006,
  TICKET_NOT_OWNER: 60007,
  INVALID_TICKET_STATUS: 60008,
  ATTACHMENT_LIMIT_EXCEEDED: 60009,

  // 权限错误 70000-79999
  PERMISSION_UNAUTHENTICATED: 70001,
  PERMISSION_UNAUTHORIZED: 70002,
  PERMISSION_TOKEN_EXPIRED: 70004,
  PERMISSION_LIMIT: 70005,
  PERMISSION_TOKEN_INVALID: 70006,
  PERMISSION_SIGNATURE_ERROR: 70007,

  // 前端本地错误 90000-99999 (非后端返回，前端客户端生成)
  /** 网络连接失败 */
  NETWORK_ERROR: 90001,
  /** 请求超时 */
  TIMEOUT_ERROR: 90002,
  /** 响应解析失败 */
  PARSE_ERROR: 90003,
  /** 未知错误 */
  UNKNOWN_ERROR: 90099,
} as const;
/**
 * 需要清除 Token 并跳转登录的错误码
 */
export const UNAUTHORIZED_CODES = [
  ResultCode.USER_NOT_LOGGED_IN,
  ResultCode.PERMISSION_UNAUTHENTICATED,
  ResultCode.PERMISSION_TOKEN_EXPIRED,
  ResultCode.PERMISSION_TOKEN_INVALID,
];

/**
 * 可重试的错误码
 */
export const RETRYABLE_CODES = [
  ResultCode.RATE_LIMIT_EXCEEDED,
  ResultCode.PERMISSION_LIMIT,
  ResultCode.SERVICE_UNAVAILABLE,
  ResultCode.SERVICE_TIMEOUT,
  ResultCode.SERVICE_CIRCUIT_OPEN,
  ResultCode.SYSTEM_BUSY,
];

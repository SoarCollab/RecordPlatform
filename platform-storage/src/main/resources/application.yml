spring:
  application:
    name: platform-storage # 应用名称
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      username: ${REDIS_USERNAME:default}
      password: ${REDIS_PASSWORD}
      database: 2

## dubbo config
dubbo:
  application:
    name: RecordPlatform_storage
    logger: slf4j
    protocol: tri
    qos-port: ${QOS_STORAGE_PORT:22332}
    qos-enable: true # 启用 QoS 功能
    qos-accept-foreign-ip: false # 只允许本机访问
    check-serializable: false # 关闭序列化检查
    serialize-check-status: DISABLE
  protocol:
    name: tri # 使用 Triple 协议
    port: ${DUBBO_STORAGE_PORT:8092}
    payload: 104857600 # 将最大载荷大小设置为 100MB (100 * 1024 * 1024 bytes)
  registry:
    register-mode: instance
    address: nacos://${NACOS_HOST:localhost}:${NACOS_PORT:8848}

# Storage 副本一致性修复配置
storage:
  consistency:
    repair:
      enabled: true
      cron: 0 0 * * * ? # 每小时执行一次
      batch-size: 100
      lock-timeout-seconds: 600 # 分布式锁超时时间（10分钟）

# 其他 Spring Boot 配置...
logging:
  level:
    cn.flying.storage: DEBUG # 保持或根据需要调整
    com.alibaba.cloud.nacos: DEBUG # Nacos 相关日志
    org.springframework.boot.context.properties.bind: TRACE # Spring Boot 属性绑定详细日志
    root: INFO
